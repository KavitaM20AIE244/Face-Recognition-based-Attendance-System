# Face Detection

This repository is a part of Computer Vision MTech Project at IIT Jodhpur. I have tested out following two methods :
* __YOLO__
* __HOG - SVM face detection__

## Problem Statement :

Face detection is a branch of computer vision that enables the detection and localization of human faces in images or video streams. Its primary objective is to accurately identify the presence and position of faces in different contexts, such as surveillance, security, photography, and social media applications. It can be a challenging task due to variations in factors such as lighting, pose, and appearance, making it an active research area in computer vision and machine learning. Recent advancements in deep learning-based methods have significantly improved the accuracy and robustness of face detection systems, which have become widely available for different practical applications. In this project I have reviewed multiple researches like RetinaFace, CenterFace, YOLO and HOG - SVM based face detection. Finally tried to implement YOLO and HOG-SVM face detection techniques.

## Dataset :

In this project I decided to implement __YOLO__ and __HOG -SVM__ features based face detection models.

So I started searching online and came across The __FDDB (Face Detection Dataset and Benchmark__ dataset. It is a dataset comprising of labeled faces from the Faces in the Wild dataset. The dataset contains 5171 face annotations with images in various resolutions such as 363x450 and 229x410. It includes both greyscale and color images and presents a variety of challenges such as difficult pose angles, out-of-focus faces, and low resolution. But the annotation available for this dataset were elliptical but I wanted to work on detecting rectangular bounding boxes. Although these can be converted to YOLO format. But I started exploring further for some other benchmark dataset and came across __Wider Face Dataset__.

The __Wider Face Dataset__ serves as a benchmark for face detection and consists of images selected from the publicly available WIDER dataset. It comprises __32,203 images__ and __393,703 labeled faces__, featuring a wide range of scale, pose, and occlusion variations, as seen in the sample images. Additionally, the dataset is categorized into 61 event classes for organization purposes.

But on analysing the results and exploring the images present in __Wider Face Dataset__, I realised it was hard dataset with face images present at multiple orientations, scale. For some cases the images were occluded and some of the images have 1000+ annotations. 

So after multiple failed attempts and also due to computation constraints to train the model Finallyy I decided to pick a simpler dataset and come across the __RoboFlow custom face dataset__ with __Training Set has 2.2k__ ,__Validation Set 209 images__ and __Testing Set 106 images__.


## Training :

### YOLO : 

Trained the YOLOV3  Architecture on __RoboFlow custom face dataset__ for more than 250+ epochs that took nearly more than 10+ hours of GPU time. Following were the metrics recorded while training the model.

![alt text](https://github.com/sagar9926/ComputerVisionProject_FaceDetection/blob/main/results/yolo_train_metrics.png)

### HOG -SVM : 

Training a HOG - SVM based face detection techniques requires the __positive images__ (images with cropped faces) and __negative images__ (images without face). 

For collecting __positive samples__ I used __UTK Face Cropped__ open source dataset. The UTKFace dataset is a comprehensive face dataset comprising over 20,000 images of individuals ranging from newborns to centenarians It includes images with diverse variations in facial expression, pose, occlusion, illumination, and resolution.

For collecting __Negative samples__ I used Natural Images dataset from Kaggle. A compiled dataset of 6899 images from 8 distinct classes which are Airplane, Car, Cat,Dog, Flower, Fruit, Person. I used the images from all the classes except the Person class for negative images.

## Evaluation :

For evaluating the performance of the two methods. I have computed the average precision for the detections generated by the two models on randomly sampled 100 images from WiderFace Dataset.

### YOLO PR Curve : 

![alt text](https://github.com/sagar9926/ComputerVisionProject_FaceDetection/blob/main/results/yolo_pr_curve1.png))

### HOG-SVM PR Curve : 

![alt text](https://github.com/sagar9926/ComputerVisionProject_FaceDetection/blob/main/results/hog_pr_curve1.png))

## Sample Detections  :

### YOLO : 

![alt text](https://github.com/sagar9926/ComputerVisionProject_FaceDetection/blob/main/results/yolo_detections.png)

#### Live face detection sample video :

[![Project](Video.png)](https://youtube.com/shorts/CvNgCwggDyM?feature=share))
### HOG - SVM :

![alt text](https://github.com/sagar9926/ComputerVisionProject_FaceDetection/blob/main/results/hog_detections.png)))


## Conclusion : 

HOG-SVM is a traditional method that relies on feature extraction and classification using support vector machines. Its performance may suffer in complex scenes with occlusions and varying lighting conditions. Also since it require a lot of hog computations that makes it infeasible to perform on live stream visual data.

On the other hand, YOLO is a modern object detection method that uses neural network to simultaneously predict object classes and bounding boxes. It is known for its speed and accuracy, especially on large datasets and in real-time applications. However, it can be computationally expensive to train a YOLO to achieve high quality results.

## References :

* https://github.com/jianlong-yuan/HOG-SVM-python
* HOG positive samples(cropped faces) : https://www.kaggle.com/datasets/abhikjha/utk-face-cropped
* Negative Sample : Natural images dataset https://www.kaggle.com/datasets/prasunroy/natural-images
* colab link : https://colab.research.google.com/drive/1YC9l0TM7Vba5EBL8j0a9zDvq631vf3n9?usp=sharing
